# 数据模型设计文档

---

## 1. Feedback 数据集
教师对学员点评和任务回复的记录。

| 字段名             | 类型       | 来源/说明                                                                 |
|--------------------|-----------|---------------------------------------------------------------------------|
| `reply_time`       | timestamp | 自动生成，教师点评提交时间                                                 |
| `user_id`          | string    | 学员 ID（对应 student.student_id），来自教研端任务分配                     |
| `student_name`         | string    | 学员昵称，来自教研任务推送                                                |
| `progress`         | float[]   | 学习进度（如 `6.1, 6.2, 7`），由老师填写                                   |
| `teacher_name`     | string    | 回复教师姓名，自动填充                                                    |
| `teacher_comment`  | string    | 教师评语，可为空                                                          |
| `push_research`    | string    | 教师推送教研备注                                                          |
| `push_ops`         | string    | 教师推送运营备注                                                          |

**说明**：  
- 一条 feedback 对应一次点评/回复。  
- 学员进度同步更新到 `student.progress`。  

---

## 2. Student 数据集
学员的基本信息、状态和跨部门备注。

| 字段名             | 类型       | 来源/说明                                                                 |
|--------------------|-----------|---------------------------------------------------------------------------|
| `student_id`       | string    | 系统生成唯一 Key                                                          |
| `external_user_id` | string    | 小鹅通 ID，由运营导入                                                     |
| `student_name`         | string    | 学员昵称，来自运营导入（小鹅通）                                          |                                                       |
| `groups`           | string[]  | 分组，运营编辑；预设：基础班 / 视唱练耳 / 中级班 / 高级班，默认=基础班     |
| `progress`         | float[]   | 学习进度，来自 feedback 中该学员的最新一条记录                             |
| `status`           | enum      | 学员状态：加入 / 活跃 / 已毕业 / 已归档（毕业/归档不在列表展示）           |
| `created_at`       | timestamp | 注册时间（或导入时间），自动生成                                           |
| `learning_hours`   | float     | 累计学习时长，来自学习平台数据导入                                        |
| `research_note`    | string    | 教研备注，教研编辑                                                        |
| `ops_note`         | string    | 运营备注，运营编辑                                                        |


---

## 3. OpsTask 数据集（运营待办事项）
运营侧对需要跟进学员的待办任务。

| 字段名             | 类型       | 来源/说明                                                                 |
|--------------------|-----------|---------------------------------------------------------------------------|
| `task_id`          | string    | 系统生成唯一 Key                                                          |
| `student_id`       | string    | 学员 ID（关联 student.student_id）                                        |
| `student_name`         | string    | 学员昵称（冗余字段，方便列表展示）                                        |
| `groups`           | string[]  | 分组（冗余字段，方便展示）                                                |
| `status`           | enum      | 学员状态（冗余字段，方便展示）                                            |
| `progress`         | float[]   | 学习进度（冗余字段，方便展示）                                            |
| `visit_count`      | int       | 回访次数                                                                 |
| `source`           | enum      | 推送来源：教师端 / 系统规则 / 教务 / 手动添加                              |
| `task_status`      | enum      | 待办状态：待办 / 已联系 / 未回复 / 已关闭                                  |
| `created_at`       | timestamp | 任务创建时间                                                              |

---

## 4. VisitRecord 数据集（回访记录）
运营或老师的回访操作历史。

| 字段名             | 类型       | 来源/说明                                                                 |
|--------------------|-----------|---------------------------------------------------------------------------|
| `record_id`        | string    | 系统生成唯一 Key                                                          |
| `student_id`       | string    | 学员 ID（关联 student.student_id）                                        |
| `student_name`         | string    | 学员昵称（冗余字段，方便列表展示）                                        |
| `visit_time`       | timestamp | 回访时间                                                                  |
| `visit_status`     | enum      | 回访状态：待办 / 已联系 / 未回复 / 已关闭                                  |
| `visit_count`      | int       | 累计回访次数                                                              |
| `teacher_name`     | string    | 任课老师                                                      |
| `visit_note`       | string    | 回访记录文本                                                              |

---

## 5. 系统角色
- **教师**：点评、推送运营/教研备注  
- **运营**：维护学员基础信息，管理运营待办、回访记录  
- **教研**：任务分配、教学质量控制，更新学员困难/异常备注  

---

## 6. 数据关系
- `student.student_id` 与 `feedback.user_id`：一对多（一个学员有多个点评反馈）。  
- `student.student_id` 与 `opstask.student_id`：一对多（一个学员可能多次进入运营待办）。  
- `student.student_id` 与 `visitrecord.student_id`：一对多（一个学员有多条回访记录）。  
- `student.progress` 始终与最新一次 feedback 同步。  

---
