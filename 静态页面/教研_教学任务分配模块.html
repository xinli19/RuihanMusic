<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•™å­¦ä»»åŠ¡åˆ†é… - ç¿æ¶µéŸ³ä¹åå°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .app-container {
            display: flex;
            height: 100vh;
        }
        
        /* å·¦ä¾§å¯¼èˆªæ  */
        .sidebar {
            width: 220px;
            background: #2d5a3d;
            color: white;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 4px rgba(0,0,0,0.1);
            transition: width 0.3s ease;
        }

        .sidebar.collapsed {
            width: 60px;
        }

        .sidebar-header {
            padding: 20px;
            background: #1e3a28;
            border-bottom: 1px solid #4a6b4a;
            position: relative;
        }

        .sidebar-header h1 {
            font-size: 18px;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
        }

        .sidebar.collapsed .sidebar-header h1 {
            opacity: 0;
        }

        .toggle-btn {
            position: absolute;
            top: 20px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            padding: 5px;
            border-radius: 3px;
            transition: background-color 0.3s;
        }

        .toggle-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .sidebar-nav {
            flex: 1;
            padding: 20px 0;
        }

        .nav-item {
            display: block;
            padding: 15px 20px;
            color: #a8c8a8;
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
            white-space: nowrap;
            overflow: hidden;
        }

        .nav-item:hover {
            background: #1e3a28;
            color: white;
            border-left-color: #4CAF50;
        }

        .nav-item.active {
            background: #1e3a28;
            color: white;
            border-left-color: #4CAF50;
        }

        .sidebar.collapsed .nav-item {
            padding: 15px 10px;
            text-align: center;
        }

        .sidebar.collapsed .nav-item span {
            display: none;
        }
        
        /* ä¸»å†…å®¹åŒºåŸŸè°ƒæ•´ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            margin-left: 0;
            transition: margin-left 0.3s ease;
        }
        
        .header {
            background: white;
            padding: 20px 30px;
            border-bottom: 1px solid #e0e0e0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header h2 {
            color: #2c3e50;
            font-size: 24px;
            margin: 0;
        }
        
        .content {
            flex: 1;
            padding: 20px 30px;
            overflow-y: auto;
        }
        
        /* åŠŸèƒ½é€‰æ‹©åŒºåŸŸ */
        .function-tabs {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .function-tabs h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 18px;
        }
        
        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab-btn {
            padding: 12px 24px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .tab-btn:hover {
            background: #3498db;
            color: white;
        }
        
        .tab-btn.active {
            background: #3498db;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* è€å¸ˆé€‰æ‹©åŒºåŸŸ */
        .teacher-stats {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .teacher-stats h3 {
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 16px;
        }
        
        .stats-grid {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            border-left: 4px solid #3498db;
            min-width: 80px;
            text-align: center;
        }
        
        .stat-teacher {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 2px;
            font-size: 14px;
        }
        
        .stat-count {
            font-size: 18px;
            font-weight: 600;
            color: #3498db;
        }
        
        /* è€å¸ˆé€‰æ‹©åŒºåŸŸ */
        .teacher-selection {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .teacher-selection h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 18px;
        }
        
        .teacher-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .teacher-btn {
            padding: 12px 20px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .teacher-btn:hover {
            background: #3498db;
            color: white;
        }
        
        .teacher-btn.active {
            background: #3498db;
            color: white;
        }
        
        /* å­¦å‘˜åˆ†é…åŒºåŸŸ */
        .student-assignment {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .assignment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .assignment-header h3 {
            color: #2c3e50;
            font-size: 18px;
        }
        
        .student-input-section {
            margin-bottom: 20px;
        }
        
        .student-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .student-suggestions {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            display: none;
        }
        
        .suggestion-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .suggestion-item:hover {
            background: #f8f9fa;
        }
        
        .suggestion-item:last-child {
            border-bottom: none;
        }
        
        /* å·²é€‰å­¦å‘˜åˆ—è¡¨ */
        .selected-students {
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .student-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            gap: 15px;
        }
        
        .student-item:last-child {
            border-bottom: none;
        }
        
        .student-name {
            min-width: 120px;
            font-weight: 500;
            color: #2c3e50;
            cursor: pointer;
            text-decoration: underline;
        }
        
        .student-name:hover {
            color: #3498db;
        }
        
        .task-remark {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .remove-btn:hover {
            background: #c0392b;
        }
        
        /* å†å²è®°å½•é€‰æ‹©åŒºåŸŸ */
        .history-selection {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .history-selection h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 18px;
        }
        
        .history-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
        }
        
        .history-item {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .history-item:hover {
            background: #f8f9fa;
        }
        
        .history-item.selected {
            background: #e3f2fd;
            border-left: 4px solid #3498db;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-teacher {
            font-weight: 600;
            color: #3498db;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .history-date {
            color: #666;
            font-size: 12px;
            margin-bottom: 8px;
        }
        
        .history-students {
            font-size: 14px;
            color: #555;
            line-height: 1.4;
        }
        
        .history-student-tag {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 11px;
            margin-right: 5px;
            margin-bottom: 3px;
        }
        
        .history-actions {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }
        
        .btn-edit {
            background: #f39c12;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .btn-edit:hover {
            background: #e67e22;
        }
        
        .btn-use {
            background: #27ae60;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .btn-use:hover {
            background: #229954;
        }
        
        /* æ“ä½œæŒ‰é’®åŒºåŸŸ */
        .action-buttons {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
        }
        
        .btn-success {
            background: #27ae60;
            color: white;
        }
        
        .btn-success:hover {
            background: #229954;
        }
        
        .btn-warning {
            background: #f39c12;
            color: white;
        }
        
        .btn-warning:hover {
            background: #e67e22;
        }
        
        .btn-secondary {
            background: #95a5a6;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #7f8c8d;
        }
        
        /* åˆ†é…è®°å½•åŒºåŸŸ */
        .assignment-records {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .assignment-records h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .records-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .records-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .btn-clear {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .btn-clear:hover {
            background: #c0392b;
        }
        
        .records-list {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .no-records {
            padding: 40px;
            text-align: center;
            color: #999;
            font-style: italic;
        }
        
        .record-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        
        .record-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .record-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .record-teacher {
            font-weight: 600;
            color: #3498db;
            font-size: 16px;
        }
        
        .record-date {
            color: #666;
            font-size: 14px;
        }
        
        .record-students {
            margin-bottom: 10px;
        }
        
        .record-students-label {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .student-item-record {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-right: 8px;
            margin-bottom: 5px;
            position: relative;
        }
        
        .delete-btn {
            margin-left: 5px;
            cursor: pointer;
            font-weight: bold;
            opacity: 0.7;
        }
        
        .delete-btn:hover {
            opacity: 1;
            color: #e74c3c;
        }
        
        .record-remarks {
            border-top: 1px solid #e9ecef;
            padding-top: 10px;
        }
        
        .record-remarks-label {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .record-remarks {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
        }
        
        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 8px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: #000;
        }
        
        .student-detail {
            line-height: 1.6;
        }
        
        .detail-item {
            margin-bottom: 10px;
        }
        
        .detail-label {
            font-weight: 500;
            color: #555;
            display: inline-block;
            width: 100px;
        }
        
        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-pending {
            background: #f39c12;
        }
        
        .status-assigned {
            background: #27ae60;
        }
        
        .status-completed {
            background: #3498db;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            
            .teacher-buttons {
                flex-direction: column;
            }
            
            .student-item {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .tab-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- å·¦ä¾§å¯¼èˆªæ  -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>æ•™ç ”ä¸­å¿ƒ</h1>
                <button class="toggle-btn" onclick="toggleSidebar()">â˜°</button>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active">ğŸ“‹ <span>æ•™å­¦ä»»åŠ¡åˆ†é…æ¨¡å—</span></a>
                <a href="#" class="nav-item">ğŸ” <span>æ•™å­¦è´¨é‡æ§åˆ¶æ¨¡å—</span></a>
            </nav>
        </div>
        
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <div class="header">
                <h2>æ•™å­¦ä»»åŠ¡åˆ†é…</h2>
            </div>
            
            <div class="content">
                <!-- åŠŸèƒ½é€‰æ‹©åŒºåŸŸ -->
                <div class="function-tabs">
                    <h3>é€‰æ‹©åˆ†é…æ–¹å¼</h3>
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="manual">æ‰‹åŠ¨æ‰¹é‡åˆ†é…</button>
                        <button class="tab-btn" data-tab="history">ä»å†å²è®°å½•é‡Œåˆ†é…</button>
                    </div>
                </div>
                
                <!-- æ‰‹åŠ¨æ‰¹é‡åˆ†é… -->
                <div id="manual-tab" class="tab-content active">
                    <!-- è€å¸ˆé€‰æ‹©åŒºåŸŸ -->
                    <div class="teacher-selection">
                        <h3>1. é€‰æ‹©åˆ†é…è€å¸ˆ</h3>
                        <div class="teacher-buttons">
                            <button class="teacher-btn" data-teacher="ç‹è€å¸ˆ">ç‹è€å¸ˆ</button>
                            <button class="teacher-btn" data-teacher="é’Ÿè€å¸ˆ">é’Ÿè€å¸ˆ</button>
                            <button class="teacher-btn" data-teacher="æè€å¸ˆ">æè€å¸ˆ</button>
                            <button class="teacher-btn" data-teacher="é»„è€å¸ˆ">é»„è€å¸ˆ</button>
                        </div>
                    </div>
                    
                    <!-- å­¦å‘˜åˆ†é…åŒºåŸŸ -->
                    <div class="student-assignment">
                        <div class="assignment-header">
                            <h3>2. æ·»åŠ å­¦å‘˜å¹¶åˆ†é…ä»»åŠ¡</h3>
                            <span id="selected-teacher-display" style="color: #3498db; font-weight: 500;">è¯·å…ˆé€‰æ‹©è€å¸ˆ</span>
                        </div>
                        
                        <div class="student-input-section">
                            <input type="text" class="student-input" id="student-search" placeholder="è¾“å…¥å­¦å‘˜å§“åè¿›è¡Œæœç´¢..." autocomplete="off">
                            <div class="student-suggestions" id="student-suggestions"></div>
                        </div>
                        
                        <div class="selected-students" id="selected-students">
                            <div style="padding: 20px; text-align: center; color: #999;">æš‚æ— é€‰æ‹©çš„å­¦å‘˜</div>
                        </div>
                    </div>
                    
                    <!-- æ“ä½œæŒ‰é’® -->
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="confirmAssignment()">ç¡®è®¤åˆ†é…</button>
                        <button class="btn btn-warning" onclick="finishAssignment()">åˆ†é…ç»“æŸ</button>
                        <button class="btn btn-secondary" onclick="exportResults()">å¯¼å‡ºç»“æœ</button>
                    </div>
                </div>
                
                <!-- ä»å†å²è®°å½•é‡Œåˆ†é… -->
                <div id="history-tab" class="tab-content">
                    <div class="history-selection">
                        <h3>é€‰æ‹©å†å²åˆ†é…è®°å½•</h3>
                        <div class="history-list" id="history-list">
                            <div style="padding: 20px; text-align: center; color: #999;">æš‚æ— å†å²è®°å½•</div>
                        </div>
                        <div class="history-actions">
                            <button class="btn btn-success" onclick="useSelectedHistory()">ä½¿ç”¨é€‰ä¸­è®°å½•</button>
                            <button class="btn btn-warning" onclick="editSelectedHistory()">ç¼–è¾‘åä½¿ç”¨</button>
                        </div>
                    </div>
                </div>
                
                <!-- ä»»åŠ¡åˆ†é…è®°å½• -->
                <div class="assignment-records">
                    <div class="records-header">
                        <h3>åˆ†é…è®°å½•</h3>
                        <div class="records-controls">
                            <span style="font-size: 14px; color: #666;">æŒ‰è€å¸ˆæ’åº</span>
                            <button class="btn-clear" onclick="clearAllRecords()">æ¸…ç©ºè®°å½•</button>
                        </div>
                    </div>
                    
                    <div class="records-list" id="records-list">
                        <div class="no-records">æš‚æ— åˆ†é…è®°å½•</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- å­¦å‘˜è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="student-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>å­¦å‘˜è¯¦æƒ…</h3>
                <span class="close" onclick="closeModal('student-detail-modal')">&times;</span>
            </div>
            <div class="student-detail" id="student-detail-content">
                <!-- å­¦å‘˜è¯¦æƒ…å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
            </div>
        </div>
    </div>
    
    <script>
        // æ¨¡æ‹Ÿå­¦å‘˜æ•°æ®
        const studentsData = [
            { id: 1, name: 'å¼ å°æ˜', group: 'åŸºç¡€ç­', progress: 'ç¬¬15è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'å­¦ä¹ ç§¯æ' },
            { id: 2, name: 'æå°çº¢', group: 'ä¸­çº§ç­', progress: 'ç¬¬8è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'éœ€è¦åŠ å¼ºç»ƒä¹ ' },
            { id: 3, name: 'ç‹å°å', group: 'é«˜çº§ç­', progress: 'ç¬¬20è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'è¡¨ç°ä¼˜ç§€' },
            { id: 4, name: 'èµµå°ä¸½', group: 'åŸºç¡€ç­', progress: 'ç¬¬10è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'è¿›åº¦ç¨æ…¢' },
            { id: 5, name: 'é™ˆå°å¼º', group: 'è§†å”±ç»ƒè€³', progress: 'è¿›è¡Œä¸­', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'éŸ³å‡†éœ€è¦æé«˜' },
            { id: 6, name: 'åˆ˜å°èŠ³', group: 'ä¸­çº§ç­', progress: 'ç¬¬12è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'èŠ‚å¥æ„Ÿå¾ˆå¥½' },
            { id: 7, name: 'å­™å°å†›', group: 'åŸºç¡€ç­', progress: 'ç¬¬5è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'åˆšå¼€å§‹å­¦ä¹ ' },
            { id: 8, name: 'å‘¨å°ç¾', group: 'é«˜çº§ç­', progress: 'ç¬¬18è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'æŠ€å·§å¨´ç†Ÿ' }
        ];
        
        let selectedTeacher = '';
        let selectedStudents = [];
        let assignmentRecords = [];
        let selectedHistoryIndex = -1;
        
        // æ¨¡æ‹Ÿå†å²åˆ†é…è®°å½•
        let historyRecords = [
            {
                teacher: 'ç‹è€å¸ˆ',
                students: [
                    { id: 1, name: 'å¼ å°æ˜', group: 'åŸºç¡€ç­', progress: 'ç¬¬15è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'å­¦ä¹ ç§¯æ', taskRemark: 'åŠ å¼ºåŸºç¡€ç»ƒä¹ ' },
                    { id: 4, name: 'èµµå°ä¸½', group: 'åŸºç¡€ç­', progress: 'ç¬¬10è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'è¿›åº¦ç¨æ…¢', taskRemark: 'éœ€è¦è€å¿ƒæŒ‡å¯¼' }
                ],
                date: '2024-01-15'
            },
            {
                teacher: 'æè€å¸ˆ',
                students: [
                    { id: 2, name: 'æå°çº¢', group: 'ä¸­çº§ç­', progress: 'ç¬¬8è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'éœ€è¦åŠ å¼ºç»ƒä¹ ', taskRemark: 'é‡ç‚¹ç»ƒä¹ èŠ‚æ‹' },
                    { id: 6, name: 'åˆ˜å°èŠ³', group: 'ä¸­çº§ç­', progress: 'ç¬¬12è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'èŠ‚å¥æ„Ÿå¾ˆå¥½', taskRemark: 'å¯ä»¥å°è¯•æ›´éš¾æ›²ç›®' }
                ],
                date: '2024-01-10'
            },
            {
                teacher: 'é’Ÿè€å¸ˆ',
                students: [
                    { id: 3, name: 'ç‹å°å', group: 'é«˜çº§ç­', progress: 'ç¬¬20è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'è¡¨ç°ä¼˜ç§€', taskRemark: 'å‡†å¤‡è€ƒçº§æ›²ç›®' },
                    { id: 8, name: 'å‘¨å°ç¾', group: 'é«˜çº§ç­', progress: 'ç¬¬18è¯¾', status: 'æ­£å¸¸å­¦ä¹ ', remarks: 'æŠ€å·§å¨´ç†Ÿ', taskRemark: 'åŠ å¼ºè¡¨ç°åŠ›è®­ç»ƒ' }
                ],
                date: '2024-01-08'
            }
        ];
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            updateTeacherStats();
            updateRecordsTable();
            updateHistoryList();
        });
        
        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
        function initializeEventListeners() {
            // åŠŸèƒ½é€‰é¡¹å¡åˆ‡æ¢
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.dataset.tab;
                    switchTab(tabName);
                });
            });
            
            // è€å¸ˆé€‰æ‹©
            document.querySelectorAll('.teacher-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // ç§»é™¤å…¶ä»–æŒ‰é’®çš„activeçŠ¶æ€
                    document.querySelectorAll('.teacher-btn').forEach(b => b.classList.remove('active'));
                    // æ·»åŠ å½“å‰æŒ‰é’®çš„activeçŠ¶æ€
                    this.classList.add('active');
                    
                    selectedTeacher = this.dataset.teacher;
                    document.getElementById('selected-teacher-display').textContent = `å½“å‰é€‰æ‹©ï¼š${selectedTeacher}`;
                });
            });
            
            // å­¦å‘˜æœç´¢
            const studentSearch = document.getElementById('student-search');
            const studentSuggestions = document.getElementById('student-suggestions');
            
            if (studentSearch) {
                studentSearch.addEventListener('input', function() {
                    const query = this.value.toLowerCase().trim();
                    
                    if (query.length === 0) {
                        studentSuggestions.style.display = 'none';
                        return;
                    }
                    
                    const filteredStudents = studentsData.filter(student => 
                        student.name.toLowerCase().includes(query) && 
                        !selectedStudents.some(s => s.id === student.id)
                    );
                    
                    if (filteredStudents.length > 0) {
                        studentSuggestions.innerHTML = filteredStudents.map(student => 
                            `<div class="suggestion-item" onclick="addStudent(${student.id})">
                                ${student.name} - ${student.group} - ${student.progress}
                            </div>`
                        ).join('');
                        studentSuggestions.style.display = 'block';
                    } else {
                        studentSuggestions.style.display = 'none';
                    }
                });
            }
        }
        
        // åˆ‡æ¢åŠŸèƒ½é€‰é¡¹å¡
        function switchTab(tabName) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.tab === tabName) {
                    btn.classList.add('active');
                }
            });
            
            // æ›´æ–°å†…å®¹æ˜¾ç¤º
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // é‡ç½®é€‰æ‹©çŠ¶æ€
            if (tabName === 'manual') {
                selectedHistoryIndex = -1;
                updateHistorySelection();
            } else if (tabName === 'history') {
                // æ¸…ç©ºæ‰‹åŠ¨é€‰æ‹©çš„è€å¸ˆå’Œå­¦å‘˜
                selectedTeacher = '';
                selectedStudents = [];
                document.querySelectorAll('.teacher-btn').forEach(btn => btn.classList.remove('active'));
                document.getElementById('selected-teacher-display').textContent = 'è¯·å…ˆé€‰æ‹©è€å¸ˆ';
                updateSelectedStudentsList();
            }
        }
        
        // æ›´æ–°å†å²è®°å½•åˆ—è¡¨
        function updateHistoryList() {
            const historyList = document.getElementById('history-list');
            
            if (historyRecords.length === 0) {
                historyList.innerHTML = '<div style="padding: 20px; text-align: center; color: #999;">æš‚æ— å†å²è®°å½•</div>';
                return;
            }
            
            historyList.innerHTML = historyRecords.map((record, index) => {
                const studentsHtml = record.students.map(student => 
                    `<span class="history-student-tag">${student.name}</span>`
                ).join('');
                
                return `
                    <div class="history-item ${selectedHistoryIndex === index ? 'selected' : ''}" onclick="selectHistory(${index})">
                        <div class="history-teacher">${record.teacher}</div>
                        <div class="history-date">åˆ†é…æ—¶é—´ï¼š${record.date}</div>
                        <div class="history-students">
                            <strong>å­¦å‘˜åˆ—è¡¨ï¼š</strong><br>
                            ${studentsHtml}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // é€‰æ‹©å†å²è®°å½•
        function selectHistory(index) {
            selectedHistoryIndex = index;
            updateHistorySelection();
        }
        
        // æ›´æ–°å†å²è®°å½•é€‰æ‹©çŠ¶æ€
        function updateHistorySelection() {
            document.querySelectorAll('.history-item').forEach((item, index) => {
                if (index === selectedHistoryIndex) {
                    item.classList.add('selected');
                } else {
                    item.classList.remove('selected');
                }
            });
        }
        
        // ä½¿ç”¨é€‰ä¸­çš„å†å²è®°å½•
        function useSelectedHistory() {
            if (selectedHistoryIndex === -1) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªå†å²è®°å½•ï¼');
                return;
            }
            
            const historyRecord = historyRecords[selectedHistoryIndex];
            
            // ç›´æ¥æ·»åŠ åˆ°åˆ†é…è®°å½•
            assignmentRecords.push({
                teacher: historyRecord.teacher,
                students: [...historyRecord.students],
                date: new Date().toISOString().split('T')[0]
            });
            
            updateTeacherStats();
            updateRecordsTable();
            
            alert(`å·²æˆåŠŸä½¿ç”¨å†å²è®°å½•ï¼Œå°† ${historyRecord.students.length} åå­¦å‘˜åˆ†é…ç»™ ${historyRecord.teacher}ï¼`);
        }
        
        // ç¼–è¾‘åä½¿ç”¨å†å²è®°å½•
        function editSelectedHistory() {
            if (selectedHistoryIndex === -1) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªå†å²è®°å½•ï¼');
                return;
            }
            
            const historyRecord = historyRecords[selectedHistoryIndex];
            
            // åˆ‡æ¢åˆ°æ‰‹åŠ¨åˆ†é…æ¨¡å¼
            switchTab('manual');
            
            // è®¾ç½®è€å¸ˆ
            selectedTeacher = historyRecord.teacher;
            document.querySelectorAll('.teacher-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.teacher === selectedTeacher) {
                    btn.classList.add('active');
                }
            });
            document.getElementById('selected-teacher-display').textContent = `å½“å‰é€‰æ‹©ï¼š${selectedTeacher}`;
            
            // è®¾ç½®å­¦å‘˜åˆ—è¡¨
            selectedStudents = [...historyRecord.students];
            updateSelectedStudentsList();
            
            alert('å·²åŠ è½½å†å²è®°å½•åˆ°ç¼–è¾‘æ¨¡å¼ï¼Œæ‚¨å¯ä»¥è¿›è¡Œä¿®æ”¹åå†åˆ†é…ï¼');
        }
        
        // æ›´æ–°è€å¸ˆç»Ÿè®¡
        function updateTeacherStats() {
            const teachers = ['ç‹è€å¸ˆ', 'é’Ÿè€å¸ˆ', 'æè€å¸ˆ', 'é»„è€å¸ˆ'];
            const statsGrid = document.querySelector('.stats-grid');
            
            if (statsGrid) {
                statsGrid.innerHTML = teachers.map(teacher => {
                    const count = assignmentRecords.reduce((total, record) => {
                        return record.teacher === teacher ? total + record.students.length : total;
                    }, 0);
                    
                    return `
                        <div class="stat-card">
                            <div class="stat-teacher">${teacher}</div>
                            <div class="stat-count">${count}äºº</div>
                        </div>
                    `;
                }).join('');
            }
        }
        
        // æ·»åŠ å­¦å‘˜
        function addStudent(studentId) {
            const student = studentsData.find(s => s.id === studentId);
            if (student && !selectedStudents.some(s => s.id === studentId)) {
                selectedStudents.push({...student, taskRemark: ''});
                updateSelectedStudentsList();
                document.getElementById('student-search').value = '';
                document.getElementById('student-suggestions').style.display = 'none';
            }
        }
        
        // æ›´æ–°å·²é€‰å­¦å‘˜åˆ—è¡¨
        function updateSelectedStudentsList() {
            const container = document.getElementById('selected-students');
            
            if (selectedStudents.length === 0) {
                container.innerHTML = '<div style="padding: 20px; text-align: center; color: #999;">æš‚æ— é€‰æ‹©çš„å­¦å‘˜</div>';
                return;
            }
            
            container.innerHTML = selectedStudents.map((student, index) => 
                `<div class="student-item">
                    <span class="student-name" onclick="showStudentDetail(${student.id})">${student.name}</span>
                    <input type="text" class="task-remark" placeholder="è¾“å…¥ä»»åŠ¡å¤‡æ³¨..." 
                           value="${student.taskRemark}" 
                           onchange="updateTaskRemark(${index}, this.value)">
                    <button class="remove-btn" onclick="removeStudent(${index})">ç§»é™¤</button>
                </div>`
            ).join('');
        }
        
        // æ›´æ–°ä»»åŠ¡å¤‡æ³¨
        function updateTaskRemark(index, remark) {
            selectedStudents[index].taskRemark = remark;
        }
        
        // ç§»é™¤å­¦å‘˜
        function removeStudent(index) {
            selectedStudents.splice(index, 1);
            updateSelectedStudentsList();
        }
        
        // æ˜¾ç¤ºå­¦å‘˜è¯¦æƒ…
        function showStudentDetail(studentId) {
            const student = studentsData.find(s => s.id === studentId);
            if (student) {
                document.getElementById('student-detail-content').innerHTML = `
                    <div class="detail-item">
                        <span class="detail-label">å§“åï¼š</span>${student.name}
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">æ‰€å±ç­çº§ï¼š</span>${student.group}
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">å­¦ä¹ è¿›åº¦ï¼š</span>${student.progress}
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">å­¦å‘˜çŠ¶æ€ï¼š</span>${student.status}
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">å¤‡æ³¨ï¼š</span>${student.remarks}
                    </div>
                `;
                document.getElementById('student-detail-modal').style.display = 'block';
            }
        }
        
        // ç¡®è®¤åˆ†é…
        function confirmAssignment() {
            if (!selectedTeacher) {
                alert('è¯·å…ˆé€‰æ‹©è€å¸ˆï¼');
                return;
            }
            
            if (selectedStudents.length === 0) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªå­¦å‘˜ï¼');
                return;
            }
            
            // æ·»åŠ åˆ°åˆ†é…è®°å½•
            assignmentRecords.push({
                teacher: selectedTeacher,
                students: [...selectedStudents],
                date: new Date().toISOString().split('T')[0] // åªä¿ç•™æ—¥æœŸéƒ¨åˆ†
            });
            
            updateTeacherStats();
            updateRecordsTable();
            
            // æ¸…ç©ºå½“å‰é€‰æ‹©
            const studentCount = selectedStudents.length;
            selectedStudents = [];
            updateSelectedStudentsList();
            
            alert(`å·²æˆåŠŸå°† ${studentCount} åå­¦å‘˜åˆ†é…ç»™ ${selectedTeacher}ï¼`);
        }
        
        // æ›´æ–°åˆ†é…è®°å½•åˆ—è¡¨
        function updateRecordsTable() {
            const recordsList = document.getElementById('records-list');
            
            if (!recordsList) return;
            
            if (assignmentRecords.length === 0) {
                recordsList.innerHTML = '<div class="no-records">æš‚æ— åˆ†é…è®°å½•</div>';
                return;
            }
            
            // æŒ‰è€å¸ˆæ’åº
            let sortedRecords = [...assignmentRecords];
            sortedRecords.sort((a, b) => a.teacher.localeCompare(b.teacher));
            
            recordsList.innerHTML = sortedRecords.map((record, recordIndex) => {
                const studentsHtml = record.students.map((student, studentIndex) => 
                    `<span class="student-item-record">${student.name}<span class="delete-btn" onclick="removeStudentFromRecord(${recordIndex}, ${studentIndex})" title="åˆ é™¤å­¦å‘˜">Ã—</span></span>`
                ).join('');
                
                const remarksHtml = record.students.map(student => 
                    `${student.name}: ${student.taskRemark || 'æ— å¤‡æ³¨'}`
                ).join('<br>');
                
                return `
                    <div class="record-item">
                        <div class="record-header">
                            <div class="record-teacher">${record.teacher}</div>
                            <div class="record-date">${record.date}</div>
                        </div>
                        <div class="record-students">
                            <div class="record-students-label">åˆ†é…å­¦å‘˜ï¼š</div>
                            ${studentsHtml}
                        </div>
                        <div class="record-remarks">
                            <div class="record-remarks-label">ä»»åŠ¡å¤‡æ³¨ï¼š</div>
                            ${remarksHtml}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // ä»åˆ†é…è®°å½•ä¸­åˆ é™¤å­¦å‘˜
        function removeStudentFromRecord(recordIndex, studentIndex) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå­¦å‘˜çš„ä»»åŠ¡åˆ†é…å—ï¼Ÿ')) {
                assignmentRecords[recordIndex].students.splice(studentIndex, 1);
                
                // å¦‚æœè¯¥è®°å½•æ²¡æœ‰å­¦å‘˜äº†ï¼Œåˆ é™¤æ•´ä¸ªè®°å½•
                if (assignmentRecords[recordIndex].students.length === 0) {
                    assignmentRecords.splice(recordIndex, 1);
                }
                
                updateTeacherStats();
                updateRecordsTable();
            }
        }
        
        // æ¸…ç©ºæ‰€æœ‰åˆ†é…è®°å½•
        function clearAllRecords() {
            if (assignmentRecords.length === 0) {
                alert('æš‚æ— åˆ†é…è®°å½•ï¼');
                return;
            }
            
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰åˆ†é…è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                assignmentRecords = [];
                updateTeacherStats();
                updateRecordsTable();
                alert('å·²æ¸…ç©ºæ‰€æœ‰åˆ†é…è®°å½•ï¼');
            }
        }
        
        // åˆ†é…ç»“æŸ
        function finishAssignment() {
            if (assignmentRecords.length === 0) {
                alert('æš‚æ— åˆ†é…è®°å½•ï¼');
                return;
            }
            
            alert('ä»»åŠ¡åˆ†é…å·²å®Œæˆï¼æ€»è¡¨å•å°†å‘é€ç»™è¿è¥ç«¯å£ã€‚');
        }
        
        // å¯¼å‡ºç»“æœ
        function exportResults() {
            if (assignmentRecords.length === 0) {
                alert('æš‚æ— åˆ†é…è®°å½•å¯å¯¼å‡ºï¼');
                return;
            }
            
            let exportData = 'æ•™å­¦ä»»åŠ¡åˆ†é…ç»“æœ\n\n';
            assignmentRecords.forEach((record, index) => {
                exportData += `åˆ†é… ${index + 1}ï¼š\n`;
                exportData += `è€å¸ˆï¼š${record.teacher}\n`;
                exportData += `æ—¶é—´ï¼š${record.date}\n`;
                exportData += `å­¦å‘˜åˆ—è¡¨ï¼š\n`;
                record.students.forEach(student => {
                    exportData += `  - ${student.name} (${student.group}) - å¤‡æ³¨ï¼š${student.taskRemark || 'æ— '}\n`;
                });
                exportData += '\n';
            });
            
            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const blob = new Blob([exportData], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `æ•™å­¦ä»»åŠ¡åˆ†é…ç»“æœ_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // å…³é—­æ¨¡æ€æ¡†
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }
        
        // éšè—å»ºè®®åˆ—è¡¨å½“ç‚¹å‡»å…¶ä»–åœ°æ–¹
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.student-input-section')) {
                const suggestions = document.getElementById('student-suggestions');
                if (suggestions) {
                    suggestions.style.display = 'none';
                }
            }
        });
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('collapsed');
        }
    </script>
</body>
</html>